---
# Ansible inventory for RHOSO and RHOSP deployment via SSH jump host (bastion)
# This inventory is designed to run all tasks on the bastion host

all:
  vars:
    # Lab-specific variables - MUST be updated for your environment
    lab_guid: "changeme"  # Replace with your lab GUID
    bastion_user: "lab-user"
    bastion_hostname: "ssh.ocpvdev01.rhdp.net"  # Replace with your bastion hostname
    bastion_port: "31295"  # Replace with your bastion SSH port
    bastion_password: "changeme"  # Replace with your bastion password
    
    # Red Hat Registry credentials (required)
    registry_username: ""  # Add your Red Hat registry service account username
    registry_password: ""  # Add your Red Hat registry service account password/token
    
    # Subscription Manager credentials (required)
    rhc_username: ""  # Add your Red Hat Customer Portal username
    rhc_password: ""  # Add your Red Hat Customer Portal password
    
    # Internal lab hostnames (accessed from bastion)
    nfs_server_hostname: "nfsserver"  # Internal hostname for NFS server
    standalone_hostname: "allinone"   # Internal hostname for standalone controller
    compute_hostname_01: "compute01"  # Internal hostname for compute node 1 (optional)
    compute_hostname_02: "compute02"  # Internal hostname for compute node 2
    compute_hostname_03: "compute03"  # Internal hostname for compute node 3
    
    # External IP configuration for OpenShift worker nodes (for RHOSO)
    rhoso_external_ip_worker_1: "172.21.0.21"  # External IP for worker node 1
    rhoso_external_ip_worker_2: "172.21.0.22"  # External IP for worker node 2  
    rhoso_external_ip_worker_3: "172.21.0.23"  # External IP for worker node 3
    
    # Bastion external IP for final network configuration
    rhoso_external_ip_bastion: "172.21.0.50"  # Update if different

# All operations run on the bastion host
bastion:
  hosts:
    bastion-jumphost:
      ansible_host: "{{ bastion_hostname }}"
      ansible_user: "{{ bastion_user }}"
      ansible_port: "{{ bastion_port }}"
      ansible_ssh_pass: "{{ bastion_password }}"
      ansible_python_interpreter: /usr/bin/python3.11
      # Uncomment if using SSH key authentication instead of password
      # ansible_ssh_private_key_file: "path/to/your/ssh/key"

# NFS server operations via SSH jump host (bastion)
nfsserver:
  hosts:
    nfs-server:
      ansible_host: "{{ nfs_server_hostname }}"
      ansible_user: "cloud-user"
      # ansible_python_interpreter: /usr/bin/python3  # Optional: Let Ansible auto-detect Python (works with Python 2.7+ or 3.x)
      ansible_ssh_private_key_file: "/home/{{ bastion_user }}/.ssh/{{ lab_guid }}key.pem"
      # SSH through bastion host
      ansible_ssh_common_args: '-o ProxyCommand="sshpass -p {{ bastion_password }} ssh -W %h:%p -p {{ bastion_port }} {{ bastion_user }}@{{ bastion_hostname }}"'

# Standalone controller (all-in-one) operations via SSH jump host (bastion)
standalone:
  hosts:
    allinone:
      ansible_host: "{{ standalone_hostname }}"
      ansible_user: "cloud-user"
      ansible_ssh_private_key_file: "/home/{{ bastion_user }}/.ssh/{{ lab_guid }}key.pem"
      # SSH through bastion host
      ansible_ssh_common_args: '-o ProxyCommand="sshpass -p {{ bastion_password }} ssh -W %h:%p -p {{ bastion_port }} {{ bastion_user }}@{{ bastion_hostname }}"'

# Compute node operations via SSH jump host (bastion)
compute_nodes:
  hosts:
    compute01:
      ansible_host: "{{ compute_hostname_01 }}"
      ansible_user: "cloud-user"
      ansible_ssh_private_key_file: "/home/{{ bastion_user }}/.ssh/{{ lab_guid }}key.pem"
      # SSH through bastion host
      ansible_ssh_common_args: '-o ProxyCommand="sshpass -p {{ bastion_password }} ssh -W %h:%p -p {{ bastion_port }} {{ bastion_user }}@{{ bastion_hostname }}"'
    compute02:
      ansible_host: "{{ compute_hostname_02 }}"
      ansible_user: "cloud-user"
      ansible_ssh_private_key_file: "/home/{{ bastion_user }}/.ssh/{{ lab_guid }}key.pem"
      # SSH through bastion host
      ansible_ssh_common_args: '-o ProxyCommand="sshpass -p {{ bastion_password }} ssh -W %h:%p -p {{ bastion_port }} {{ bastion_user }}@{{ bastion_hostname }}"'
    compute03:
      ansible_host: "{{ compute_hostname_03 }}"
      ansible_user: "cloud-user"
      # ansible_python_interpreter: /usr/bin/python3  # Optional: Let Ansible auto-detect Python (works with Python 2.7+ or 3.x)
      ansible_ssh_private_key_file: "/home/{{ bastion_user }}/.ssh/{{ lab_guid }}key.pem"
      # SSH through bastion host
      ansible_ssh_common_args: '-o ProxyCommand="sshpass -p {{ bastion_password }} ssh -W %h:%p -p {{ bastion_port }} {{ bastion_user }}@{{ bastion_hostname }}"'
